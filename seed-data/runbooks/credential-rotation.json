{
  "runbook_id": "runbook-credential-rotation",
  "title": "Credential Rotation for Compromised Service Accounts",
  "description": "Step-by-step procedure for rotating compromised API keys, service account credentials, and access tokens. Includes pre-rotation validation, rolling rotation to avoid downtime, and post-rotation verification.",
  "content": "When a service account credential is confirmed compromised: (1) Identify all systems using the credential, (2) Generate new credentials in the secrets manager, (3) Update dependent services using rolling deployment, (4) Revoke the old credential, (5) Verify all services authenticate successfully with new credentials, (6) Monitor for unauthorized access attempts using old credentials.",
  "incident_types": [
    "credential_compromise",
    "api_key_exposure",
    "token_theft"
  ],
  "applicable_services": [
    "payment-service",
    "user-service",
    "api-gateway",
    "notification-svc"
  ],
  "severity_levels": [
    "critical",
    "high"
  ],
  "steps": [
    {
      "order": 1,
      "action": "Identify all systems and services using the compromised credential",
      "command": "vigil-esql-blast-radius",
      "target_system": "elasticsearch",
      "approval_required": false,
      "rollback_command": null
    },
    {
      "order": 2,
      "action": "Generate new credentials in the secrets manager",
      "command": "secrets-manager rotate-secret --secret-id {{secret_id}}",
      "target_system": "secrets-manager",
      "approval_required": false,
      "rollback_command": "secrets-manager restore-secret --secret-id {{secret_id}} --version previous"
    },
    {
      "order": 3,
      "action": "Update dependent services with new credentials via rolling deployment",
      "command": "kubectl rollout restart deployment/{{deployment_name}} -n vigil-demo",
      "target_system": "kubernetes",
      "approval_required": false,
      "rollback_command": "kubectl rollout undo deployment/{{deployment_name}} -n vigil-demo"
    },
    {
      "order": 4,
      "action": "Revoke the compromised credential",
      "command": "secrets-manager revoke-secret --secret-id {{secret_id}} --version compromised",
      "target_system": "secrets-manager",
      "approval_required": true,
      "rollback_command": "secrets-manager restore-secret --secret-id {{secret_id}} --version compromised"
    },
    {
      "order": 5,
      "action": "Verify all services authenticate successfully with new credentials",
      "command": "vigil-esql-health-comparison",
      "target_system": "elasticsearch",
      "approval_required": false,
      "rollback_command": null
    }
  ],
  "historical_success_rate": 0.94,
  "times_used": 12,
  "last_used_at": "2026-02-10T14:22:00.000Z",
  "tags": [
    "credential",
    "rotation",
    "api-key",
    "service-account",
    "secrets-manager"
  ],
  "content_vector": [
    -0.08771270501468191,
    -0.00894357382877889,
    -0.02387987341808511,
    -0.06388204207498971,
    0.02398304692459093,
    -0.032244199991247134,
    0.054736736376862855,
    0.12130214577112712,
    0.00802023445426864,
    0.06090739136014048,
    -0.020382628896769315,
    0.014693792216615133,
    0.0026183567722660186,
    0.031777998033843756,
    0.045277836679571484,
    0.10109273060557801,
    -0.06367133882911005,
    -0.013540998970891595,
    0.04776276674134602,
    0.006061938746139015,
    0.03952363270100309,
    -0.01822815238805008,
    0.03759710300057766,
    0.09895708725042308,
    0.00999890761005516,
    -0.030346841937706873,
    0.06252702354030139,
    0.07363050315194676,
    0.0885914254383557,
    -0.04299928273432377,
    0.0033535705298442815,
    -0.022246589710456573,
    -0.1454183993118791,
    0.06828734001688241,
    -0.07620448108297179,
    0.07627183208793717,
    -0.0533461490673143,
    0.06285818787863422,
    0.02688994138106361,
    -0.010698095881786556,
    -0.010917356191663093,
    0.04965934603787163,
    0.08965293176992749,
    0.003933630323048162,
    -0.03610489732776371,
    -0.034555112605395885,
    -0.005941351379557599,
    -0.042183518379391355,
    -0.058275355542463415,
    -0.05618508915874895,
    -0.020616465055301604,
    0.05351031385473333,
    0.09308023117786109,
    -0.05822723715842805,
    -0.022754487331425634,
    0.011594342997081135,
    -0.03088958733831226,
    -0.008050115985751451,
    0.021276172733613808,
    0.022705824635578697,
    0.06956640869472565,
    -0.03722010737453678,
    0.11138477861621106,
    0.04441727141809646,
    -0.008786560981466093,
    0.06904279244294971,
    0.019177137946509364,
    0.01985398704045108,
    0.003137354742973417,
    0.07867252705924162,
    -0.05623677387127428,
    -0.04097172052756372,
    -0.0622285182464558,
    0.01590958333411135,
    -0.020820311927970354,
    -0.010055343154501824,
    -0.05218279858785428,
    -0.05181602478392643,
    0.08112247458508924,
    -0.014632734844368167,
    -0.02705595405893791,
    0.015934879354879847,
    0.02742465644597101,
    -0.005914955423226384,
    0.09964808903033136,
    0.0823087805490249,
    0.10725296537745241,
    0.010037209923121949,
    -0.002820369353553356,
    0.05793668231914791,
    -0.016852199526658767,
    0.0044515141118451115,
    -0.013662525095289724,
    -0.05951882235987645,
    0.019012870738778578,
    0.005625799525836234,
    -0.08437861372840305,
    -0.023622166539930912,
    0.03398225545036715,
    -0.035906518948725256,
    0.04091196487638194,
    -0.04043722260316899,
    0.020086382963490818,
    -0.04733338109540597,
    0.11095187617572552,
    0.00026326085061487375,
    0.0630388240828222,
    0.003581874318068821,
    -0.08944549252054541,
    0.046790805343705076,
    0.03651668683345282,
    -0.0871637259524646,
    -0.05383605177023304,
    -0.0804469415350706,
    -0.07667619544836381,
    -0.09145772327382103,
    -0.06144930804857629,
    -0.007847475192141767,
    0.048760958968261985,
    0.029252189871632247,
    0.031454621565728626,
    -0.05117535001687035,
    0.06424822178586279,
    -0.07766318993847421,
    0.0006381492296547561,
    -0.060651124555413695,
    -0.052636822616267,
    0.028932122109782913,
    -0.0491673534406716,
    0.08602626995758669,
    0.016215302833107858,
    -0.03535535788902348,
    0.023334078940584667,
    0.08515090645072743,
    -0.013329306601533171,
    -0.04651383205699794,
    0.006827645880352769,
    -0.0010358949833748413,
    0.08191297084546113,
    0.03456225008551003,
    -0.019442656164119918,
    0.006973536214069453,
    -0.010211065640692608,
    -0.01034936001453033,
    -0.0964660860838512,
    0.04180355777942802,
    -0.054309803842210506,
    0.05080319821500945,
    -0.06924000916800911,
    -0.059004607367425015,
    -0.10115649342420654,
    0.016818379000088104,
    -0.01852987285517484,
    0.004865934705650098,
    -0.036735334336938257,
    -0.019347152662344012,
    0.028364457541628273,
    -0.07003763002894259,
    -0.028558602035404553,
    0.0852318859718764,
    0.03366030582609292,
    0.023158268115584406,
    0.05656563264105842,
    -0.08257767637799954,
    0.03420894025844828,
    0.018199682430784788,
    -0.04740256386714058,
    0.021193031682041803,
    -0.05062833394639971,
    -0.012885559872875178,
    0.04395407816233211,
    -0.0660791253501746,
    -0.013071815004603013,
    0.048248413156220096,
    -0.027018908843493422,
    -0.058796273355224166,
    0.007204329663213549,
    -0.027700865996752123,
    -0.004022839406821694,
    0.08501401506926452,
    0.023138648379623407,
    0.02778486712100835,
    0.03377873005053077,
    0.061293130892234676,
    0.018586259759388463,
    0.05204039205996202,
    -0.050536425950155804,
    -0.05540758768890861,
    -0.027110478889055132,
    0.03961051696753086,
    0.0219690952696046,
    0.10653909491600386,
    0.010246463513626073,
    0.0950077241927732,
    0.030485124856806725,
    -0.007086188780963868,
    0.009936869250607333,
    0.023864971568768517,
    -0.032998378015190136,
    0.12198912331833361,
    -0.019010065786165032,
    0.025598050111044768,
    0.024290391273869616,
    0.05761227319837505,
    -0.024197876348928643,
    0.035460930354320394,
    -0.05419473344943681,
    -0.04378303017426622,
    0.04358138773479232,
    -0.00860969878355012,
    -0.05562864281143845,
    0.042254993710464366,
    -0.028385964946609006,
    -0.09620307080838104,
    -0.06356313874448294,
    0.03585011821787356,
    0.015431438502246552,
    0.04662694032638017,
    -0.03576904058648759,
    0.042233464580112894,
    -0.10951372200925258,
    0.015720412396254258,
    0.04449972023882947,
    -0.019604541988198904,
    -0.02882320007750238,
    0.04015957258374359,
    -0.03697023254268932,
    -0.0018278999620979727,
    -0.009831087679783312,
    0.015557452836409085,
    0.026240996740199914,
    -0.02811575423050073,
    -0.05495712951091122,
    -0.03616441999431916,
    -0.013315792351210522,
    0.08321008357234064,
    -0.054381208143906366,
    -0.08143944562305751,
    0.055519504283069426,
    0.07635503377579189,
    0.003846780700112313,
    -0.1284013813865724,
    0.012933190545461049,
    0.11768528966420022,
    0.08096196338705997,
    0.017577810321521496,
    -0.03630897691994312,
    -0.011051115807081733,
    -0.08357463961651114,
    0.004649507867515525,
    -0.028584591435988318,
    0.050853652943151154,
    -0.11955305331331374,
    -0.029435656120184294,
    -0.03165127255949577,
    -0.05322014544306677,
    -0.10265561445731773,
    0.05004325870364097,
    -0.04557010422740666,
    0.022200717825928848,
    0.07019203729309796,
    -0.023369477725891482,
    0.03804487389694121,
    -0.09822786608247604,
    -0.0048816075308999955,
    0.042609478360308345,
    -0.041959350160145,
    -0.011332513399047173,
    0.003961296047712245,
    -0.03732290021157149,
    -0.0839585075571882,
    -0.009979316810369385,
    -0.003596980739620069,
    0.02648748126929409,
    0.008260928841413114,
    -0.10570052051136045,
    -0.006873277811419291,
    0.08008020300979812,
    -0.10264698450177659,
    0.039540473624700784,
    -0.02167047050682781,
    0.03738028541254445,
    -0.0018510239250046176,
    -0.05416970765490531,
    0.025794644484426085,
    -0.05084580662220048,
    0.033307841372570396,
    0.10481495837605107,
    0.02349823367633374,
    0.0709444943397477,
    0.026235014913433177,
    -0.06031099109889125,
    -0.029888623302135955,
    0.018052657709265226,
    0.07271761914725508,
    0.024698566548386598,
    -0.030627679899294557,
    -0.018936443918942954,
    0.09555872556678378,
    -0.02914920021978602,
    -0.010558383896129822,
    -0.03346258349412031,
    -0.017923934176808463,
    0.020173630335899355,
    -0.010317499639832247,
    0.05189067821961311,
    0.06775957344652417,
    -0.09155459275685837,
    0.015903830325559136,
    0.05454806600765228,
    -0.05525966580660043,
    0.081870365034737,
    -0.011592997034091829,
    0.007390388555986177,
    0.012427322149877962,
    0.020948667518227777,
    -0.01956377626931425,
    0.022651142376853336,
    -0.002823779195850602,
    -0.060643447193706145,
    0.026943840186201426,
    0.02863449549295228,
    -0.008412250240079508,
    0.01865358475007298,
    0.052714361784549246,
    -0.0115152452796594,
    -0.026817214049077553,
    -0.00013833823724461642,
    0.04590721478392127,
    0.04524629201673112,
    -0.020049721337789494,
    -0.023591930585928594,
    0.02124040040147738,
    -0.03406356622500151,
    0.03378096509984984,
    -0.07589742980546468,
    0.02696837672258243,
    0.018273961257611413,
    0.09075269426932375,
    -0.003913164986308001,
    0.03593889700145049,
    -0.05611191945415756,
    -0.034109399981947695,
    0.07257723727591153,
    -0.035466986661600815,
    -0.000609919219200617,
    -0.0287816889036994,
    0.01836187179899834,
    0.04498540454756487,
    -0.0474323919787446,
    -0.005527587721623248,
    -0.008521263271700379,
    0.03235102786547512,
    -0.05423080707340854,
    0.0038125833194228185,
    -0.03115766552802178,
    0.01192564837092421,
    -0.0037063848183290196,
    -0.07524993148422872,
    -0.07136284141261331,
    0.01773230460888619,
    0.007529215576202804,
    0.07565824738695096,
    -0.08945500084760477,
    -0.043919437219590934,
    -0.0006471143735621008,
    0.12321454152771491,
    -0.06382937136890716,
    -0.044354527777145394,
    -0.032817370622081676,
    -0.020356917747288237,
    0.020827061942563067,
    -0.010232316629840284,
    -0.08797308004602634,
    0.029819928454802278,
    0.013058925404653088,
    -0.017538508222456842,
    0.09133835328807437,
    0.06862524182634205,
    0.050067209494077176,
    -0.0502200865075519,
    0.08678268753222611,
    0.021461490235047755,
    0.005413058625194704
  ]
}
