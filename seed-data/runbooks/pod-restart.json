{
  "runbook_id": "runbook-pod-restart",
  "title": "Pod Restart for Unhealthy Services",
  "description": "Procedure for restarting Kubernetes pods when a service is in a degraded state due to memory leaks, stuck processes, or corrupted state. Includes pre-restart health snapshot, rolling restart, and post-restart verification.",
  "content": "When a service is in a degraded state without a clear deployment correlation: (1) Capture current health metrics as pre-restart snapshot, (2) Verify sufficient replica count for rolling restart without downtime, (3) Execute rolling restart, (4) Wait for all pods to reach Ready state, (5) Verify health metrics return to baseline.",
  "incident_types": [
    "service_degradation",
    "resource_exhaustion",
    "memory_leak",
    "pod_crash_loop"
  ],
  "applicable_services": [
    "api-gateway",
    "payment-service",
    "user-service",
    "notification-svc"
  ],
  "severity_levels": [
    "high",
    "medium",
    "low"
  ],
  "steps": [
    {
      "order": 1,
      "action": "Capture current health metrics as pre-restart baseline",
      "command": "vigil-esql-health-monitor",
      "target_system": "elasticsearch",
      "approval_required": false,
      "rollback_command": null
    },
    {
      "order": 2,
      "action": "Verify sufficient replica count (minimum 2 for zero-downtime restart)",
      "command": "kubectl get deployment/{{deployment_name}} -n vigil-demo -o jsonpath='{.spec.replicas}'",
      "target_system": "kubernetes",
      "approval_required": false,
      "rollback_command": null
    },
    {
      "order": 3,
      "action": "Execute rolling restart of the deployment",
      "command": "kubectl rollout restart deployment/{{deployment_name}} -n vigil-demo",
      "target_system": "kubernetes",
      "approval_required": false,
      "rollback_command": "kubectl rollout undo deployment/{{deployment_name}} -n vigil-demo"
    },
    {
      "order": 4,
      "action": "Wait for all pods to reach Ready state",
      "command": "kubectl rollout status deployment/{{deployment_name}} -n vigil-demo --timeout=120s",
      "target_system": "kubernetes",
      "approval_required": false,
      "rollback_command": null
    }
  ],
  "historical_success_rate": 0.96,
  "times_used": 23,
  "last_used_at": "2026-02-16T11:30:00.000Z",
  "tags": [
    "pod-restart",
    "kubernetes",
    "rolling-restart",
    "service-recovery"
  ],
  "content_vector": [
    -0.04951798849071366,
    0.035539641872427044,
    0.05677217210429257,
    -0.012477509392192367,
    -0.08322118439920234,
    0.08220330701790383,
    0.016150845253199448,
    -0.011462912712729542,
    -0.012962330655386649,
    0.06579884868861138,
    -0.052960077213437096,
    -0.0416937520763268,
    -0.004322756302149553,
    0.026806695743179728,
    0.07587021340140317,
    -0.06759912478899086,
    0.07468628580827602,
    0.0796348007215081,
    0.019818600446727796,
    0.07619107961052811,
    0.07033424542960752,
    -0.035435055009499054,
    -0.006397600762009307,
    0.061224531020755306,
    -0.012304808885194193,
    -0.03902234605925056,
    -0.030277113695685486,
    -0.033109237304851935,
    0.03621193486000211,
    0.032970395283342564,
    -0.04346357627974241,
    0.08963727662181949,
    -0.028192565928637513,
    0.0821608899980756,
    -0.051108538379886694,
    0.0009074717285880356,
    0.007758349269509964,
    -0.012820979503503463,
    0.08857028986741398,
    0.07663281451838166,
    -0.06268384747059855,
    -0.08247712668271008,
    0.039634136612279075,
    0.02881647374322143,
    0.009614836703530286,
    -0.007350699753221388,
    0.04483723668782691,
    -0.056382924157679405,
    -0.006200193868530241,
    0.10432963498450605,
    0.008295544401076684,
    -0.07537394147794343,
    0.011106878250651193,
    -0.0023007873879348443,
    0.05482364923159346,
    0.08002948174226668,
    -0.010728232899332677,
    -0.021506109102574347,
    -0.021699588532596722,
    0.024029398406862114,
    0.018034739632412,
    0.003257513146130663,
    -0.015133111535236396,
    -0.07368569442483709,
    0.014723711753418014,
    -0.027637630681628656,
    -0.02347247086249914,
    -0.11405855198755627,
    -0.06921608923454133,
    -0.012868124834595708,
    -0.0057868610855274175,
    0.030684563449304453,
    0.012281863680907149,
    0.04355513597185329,
    0.0016310358351741842,
    0.02721614487597415,
    -0.044024870713816014,
    0.059987254814319116,
    0.004143439650525713,
    -0.059895544632184015,
    0.02210087751191028,
    0.07101343849551676,
    0.005605372316211687,
    -0.017030449612355093,
    -0.009419010097860094,
    -0.006073816622643836,
    -0.05090728531996249,
    -0.017620855178881515,
    0.07707528393071399,
    0.07835648766188799,
    0.018418868771497208,
    -0.007452156936727077,
    0.07038697613845682,
    -0.009524284539792443,
    0.06238337885394085,
    0.015614016254644479,
    0.023390420946609022,
    -0.10672622035181645,
    0.013091005560367186,
    -0.022062216092008674,
    -0.051499391997719066,
    -0.04715821889212085,
    0.012812853605682125,
    0.064578344212767,
    -0.06932699153339268,
    -0.10405399999861246,
    0.1107180377607909,
    0.03481467598397435,
    0.03277867416145322,
    0.024660452357647338,
    0.07411566295724158,
    -0.035294798300004225,
    -0.059841775989827546,
    0.013020411548305792,
    0.008843993887758536,
    0.10556003255257394,
    -0.08089214791227646,
    -0.003180780040842608,
    -0.041314652353562055,
    0.04655855893827504,
    0.06283500459313934,
    0.07146408381330996,
    0.06303469386687904,
    -0.07207761207419972,
    0.012333154270388611,
    0.028293056294807245,
    0.1106944638319105,
    -0.016807588660698314,
    -0.018791248100273182,
    -0.004370671433917175,
    -0.03629025590920747,
    -0.03469484814331634,
    0.01008564516863403,
    0.0538324650879662,
    -0.023737211714312593,
    -0.037075328447809495,
    0.061278424059096955,
    -0.04876933411158459,
    -0.009681260675869413,
    0.07466829408414322,
    -0.018789548945762236,
    -0.04702268861252139,
    0.020867059038776073,
    0.05253150528976852,
    0.08610366188820767,
    0.05669545433634954,
    0.024206341959555802,
    -0.03206319603098077,
    0.07076550529497595,
    0.02723578734794245,
    -0.01601303873839172,
    -0.016746408464536712,
    -0.03853828601412952,
    -0.014075951335222835,
    -0.03529330013299185,
    -0.0835874533455684,
    0.05911289912669406,
    0.061357011681849524,
    0.055782886569779325,
    -0.03685351460438046,
    0.06616948770584082,
    -0.005904819127078937,
    -0.08167100696157548,
    0.07195449162868907,
    -0.049527213843517014,
    0.019898967658912976,
    0.03466412606978996,
    -0.010134740238711557,
    0.02406103808562097,
    -0.0022614662415839214,
    -0.006448014923172652,
    -0.02647101913709086,
    -0.05349040079448753,
    0.08919353377068297,
    0.0053096712133001945,
    0.11213795010127849,
    0.010337906201810456,
    -0.05058753768236603,
    0.010319254176499709,
    -0.055701593738775756,
    0.014704346130487605,
    -0.07108839781834053,
    -0.08676525937719022,
    -0.04050189785996318,
    -0.023702568547054534,
    -0.04519432858390351,
    0.008527906797053942,
    0.04675757239442088,
    0.037324266956922494,
    0.006169239942939878,
    0.051982268618239506,
    0.09894278665802886,
    -0.012475997884032752,
    0.058508170736060364,
    0.0070749707245260545,
    -0.04619074531842379,
    -0.10459322293267766,
    0.0002489348876375811,
    -0.05677973374327549,
    0.020871717449155038,
    0.002203382989768728,
    0.04041219000047279,
    -0.04826121466941384,
    0.038360587037639796,
    -0.05189614697633975,
    -0.007813668867037438,
    -0.0143054328891733,
    0.015241960605006818,
    -0.05238602427528954,
    0.013198436186681203,
    -0.019217905040439603,
    0.02885359804804409,
    -0.06310525763175218,
    -0.03952365431037118,
    0.06932900809351752,
    -0.028933671903542672,
    0.10413255735562703,
    0.013689748535775339,
    -0.016351862777254027,
    0.04090574981008102,
    0.007283346689867615,
    -0.004351025829403284,
    -0.12679256009844656,
    0.07708697682975059,
    0.05730995513660606,
    -0.022062589414436104,
    0.018843512041346246,
    0.022709318690774187,
    0.031133126733031362,
    0.043989326668375184,
    -0.046928150616885905,
    0.020499730750139406,
    0.020324219184065996,
    -0.080011957792224,
    0.061325913183046823,
    0.051269016733293545,
    0.026082600789428066,
    0.06330721470852091,
    0.010719933752527479,
    -0.04089019254070918,
    0.0933034893233162,
    0.009538010967110686,
    -0.022222424658255028,
    0.023388977503901152,
    0.09533713668761344,
    -0.05152986276664694,
    -0.024063438614596113,
    -0.065685732931282,
    0.00073562565823724,
    -0.015973140781110742,
    0.03428815383190664,
    -0.030747913522505603,
    0.04015513877729387,
    2.0876466977756704e-06,
    0.04491842476818037,
    -0.06976486520868676,
    -0.08055975291751923,
    0.007689763972283623,
    0.054996313909125474,
    -0.05208424464257179,
    0.12025299549101647,
    -0.11719504438111683,
    0.030189096929281185,
    0.020071784540931156,
    0.0018047683599153336,
    0.06791800657659121,
    -0.05347946100638315,
    -0.06732845495115483,
    0.06190995316434987,
    -0.019880344277926103,
    -0.1324192254000228,
    -0.13125401060484632,
    0.013155698356754246,
    0.002042729251690586,
    -0.032406923945271844,
    0.054672916986351176,
    -0.01043899123644174,
    0.00821445233626708,
    0.04041453884418842,
    0.03254354155355954,
    0.049517706201177514,
    -0.025908804901032124,
    -0.06103557445323197,
    0.036794151885932005,
    -0.05857791357494258,
    0.00864299145097933,
    -0.0858855525578747,
    -0.021703482330977308,
    -0.005654374291930758,
    0.01584227909744966,
    -0.007450411713181675,
    -0.02690372885558672,
    -0.050656577586414495,
    0.04115937417838668,
    -0.09544097078446477,
    -0.005025547825014557,
    -0.036681567298325224,
    -0.1271168215822959,
    -0.04391234670411716,
    -0.0552304631729741,
    -0.04027572895849288,
    -0.004481007554835209,
    0.038531250088510875,
    -0.008657870234088528,
    -0.03560386157415473,
    0.054126733167848905,
    0.009893715415038876,
    -0.013642853912966735,
    0.0028059857560179396,
    0.08183126054907547,
    0.04870986713400181,
    -0.05024806375895402,
    -0.00035917178022615265,
    -0.08527568798786585,
    0.024288637159935997,
    -0.018829754407180987,
    -0.07157538190795387,
    -0.05430141562400124,
    0.015575934094984045,
    -0.030887336086826755,
    0.08148505085213725,
    0.017487765811980357,
    -0.10395453367099051,
    0.055081400623354475,
    0.021786339642483436,
    0.05661937374301476,
    0.009022108752777478,
    -0.09384523228820121,
    -0.0025110555069050313,
    -0.028378031145800207,
    0.022964175731411858,
    -0.06450591846809807,
    0.019558326759913446,
    -0.015284214126863573,
    0.04158683495210757,
    0.023702423366790643,
    0.05294392603485355,
    0.06185627415377094,
    -0.06463442121156258,
    0.07108664663681483,
    0.03225273053697911,
    -0.021057098127916684,
    -0.011059463844519868,
    -0.009888993208523036,
    -0.05780665231991702,
    -0.050287319323520374,
    0.07493451591205726,
    -0.00821235307464455,
    -0.07396622614754733,
    0.02777824464794069,
    0.034479648410695805,
    0.007435352547969824,
    0.0377337352948275,
    0.11394116790488742,
    0.059459084017230324,
    -0.008360171272682413,
    0.05207089545026524,
    0.032742901567246914,
    0.04414402842422826,
    0.08029846975191192,
    0.018941748469024446,
    0.0892877753304553,
    -0.06598119990240178,
    0.006218625267872327,
    -0.09265741387155867,
    0.07036125177891964,
    -0.07136699627449708,
    -0.043279838896896385,
    -0.018602981959314382,
    0.041464739982062314,
    -0.05840627628301167,
    -0.05632711171134182,
    -0.04568971410487645,
    0.007992024017898426,
    -0.031213102563619373,
    -0.018912736365039876,
    -0.01553960870388002,
    -0.10821893680619799,
    -0.031514226252039264,
    -0.003989534570931146,
    -0.023825489412404366,
    -0.025103367668492756,
    -0.0322559039368173,
    0.013121908019264302
  ]
}
