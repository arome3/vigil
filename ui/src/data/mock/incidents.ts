import type { Incident } from "@/types/incident";

export const mockIncidents: Incident[] = [
  // Incident 1 — Compromised API Key (Security)
  {
    id: "INC-2026-00142",
    status: "resolved",
    severity: "critical",
    type: "security",
    title:
      "Compromised API key — external data exfiltration from payment service",
    priority_score: 0.92,
    created_at: "2026-02-17T10:30:00Z",
    updated_at: "2026-02-17T10:34:12Z",
    resolved_at: "2026-02-17T10:34:12Z",
    reflection_count: 0,
    current_agent: "vigil-verifier",
    timing_metrics: {
      time_to_detect_seconds: 2,
      time_to_investigate_seconds: 48,
      time_to_remediate_seconds: 22,
      time_to_verify_seconds: 15,
      total_duration_seconds: 252,
    },
    investigation: {
      investigation_id: "INV-2026-00142",
      root_cause:
        "Compromised API key for svc-payment account used to access payment service and exfiltrate customer data to external C2 server at 198.51.100.10",
      attack_chain: [
        {
          step: 1,
          technique_id: "T1552",
          technique_name: "Unsecured Credentials",
          tactic: "credential-access",
          source: "svc-payment",
          target: "srv-payment-01",
          confidence: 0.95,
          evidence_count: 4,
        },
        {
          step: 2,
          technique_id: "T1071",
          technique_name: "Application Layer Protocol",
          tactic: "command-and-control",
          source: "srv-payment-01",
          target: "198.51.100.10",
          confidence: 0.88,
          evidence_count: 12,
        },
        {
          step: 3,
          technique_id: "T1041",
          technique_name: "Exfiltration Over C2 Channel",
          tactic: "exfiltration",
          source: "srv-payment-01",
          target: "198.51.100.10",
          confidence: 0.91,
          evidence_count: 8,
        },
      ],
      blast_radius: [
        {
          asset_id: "srv-payment-01",
          asset_name: "srv-payment-01",
          asset_type: "host",
          criticality: "tier-1",
          impact_type: "compromised",
          confidence: 0.95,
        },
        {
          asset_id: "srv-api-gateway",
          asset_name: "srv-api-gateway",
          asset_type: "service",
          criticality: "tier-1",
          impact_type: "lateral_movement_risk",
          confidence: 0.72,
        },
        {
          asset_id: "db-customers",
          asset_name: "db-customers",
          asset_type: "database",
          criticality: "tier-1",
          impact_type: "data_exfiltration",
          confidence: 0.88,
        },
      ],
      mitre_techniques: ["T1552", "T1071", "T1041"],
      recommended_next: "plan_remediation",
    },
    remediation_plan: {
      actions: [
        {
          order: 1,
          action_type: "containment",
          description:
            "Block source IP 203.0.113.42 at perimeter firewall and WAF",
          target_system: "firewall",
          approval_required: false,
          status: "completed",
          execution_time_ms: 1200,
        },
        {
          order: 2,
          action_type: "containment",
          description:
            "Disable svc-payment service account and revoke all active sessions",
          target_system: "iam",
          approval_required: false,
          status: "completed",
          execution_time_ms: 800,
        },
        {
          order: 3,
          action_type: "remediation",
          description:
            "Rotate all API keys and secrets for payment-service, invalidate cached tokens",
          target_system: "vault",
          approval_required: true,
          status: "completed",
          execution_time_ms: 3500,
        },
        {
          order: 4,
          action_type: "communication",
          description:
            "Notify #vigil-incidents Slack channel with incident summary and blast radius",
          target_system: "slack",
          approval_required: false,
          status: "completed",
          execution_time_ms: 400,
        },
        {
          order: 5,
          action_type: "documentation",
          description:
            "Create Jira ticket SEC-4521 for post-incident review and compliance tracking",
          target_system: "jira",
          approval_required: false,
          status: "completed",
          execution_time_ms: 600,
        },
      ],
      success_criteria: [
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 0.5,
          service_name: "payment-service",
        },
        {
          metric: "latency_p99_ms",
          operator: "lt",
          threshold: 200,
          service_name: "payment-service",
        },
        {
          metric: "active_connections_from_blocked_ip",
          operator: "eq",
          threshold: 0,
          service_name: "firewall",
        },
      ],
    },
    verification: {
      iteration: 1,
      health_score: 0.95,
      passed: true,
      criteria_results: [
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 0.5,
          service_name: "payment-service",
          current_value: 0.08,
          passed: true,
        },
        {
          metric: "latency_p99_ms",
          operator: "lt",
          threshold: 200,
          service_name: "payment-service",
          current_value: 42,
          passed: true,
        },
        {
          metric: "active_connections_from_blocked_ip",
          operator: "eq",
          threshold: 0,
          service_name: "firewall",
          current_value: 0,
          passed: true,
        },
      ],
    },
    affected_assets: [
      {
        asset_id: "srv-payment-01",
        asset_name: "srv-payment-01",
        asset_type: "host",
        criticality: "tier-1",
        impact_type: "compromised",
        confidence: 0.95,
      },
      {
        asset_id: "srv-api-gateway",
        asset_name: "srv-api-gateway",
        asset_type: "service",
        criticality: "tier-1",
        impact_type: "lateral_movement_risk",
        confidence: 0.72,
      },
      {
        asset_id: "db-customers",
        asset_name: "db-customers",
        asset_type: "database",
        criticality: "tier-1",
        impact_type: "data_exfiltration",
        confidence: 0.88,
      },
    ],
    external_links: {
      jira_ticket: "https://acme-corp.atlassian.net/browse/SEC-4521",
      slack_thread:
        "https://acme-corp.slack.com/archives/C05VIGIL/p1739785800",
      pagerduty_incident:
        "https://acme-corp.pagerduty.com/incidents/P8X2YZ1",
      github_commit:
        "https://github.com/acme-corp/infra-config/commit/e4f7a2b",
    },
    _state_timestamps: {
      detected: "2026-02-17T10:30:00Z",
      triaged: "2026-02-17T10:30:43Z",
      investigating: "2026-02-17T10:30:45Z",
      threat_hunting: "2026-02-17T10:31:02Z",
      planning: "2026-02-17T10:31:47Z",
      awaiting_approval: "2026-02-17T10:31:50Z",
      executing: "2026-02-17T10:32:05Z",
      verifying: "2026-02-17T10:33:12Z",
      resolved: "2026-02-17T10:34:12Z",
    },
  },

  // Incident 2 — Bad Deployment (Operational)
  {
    id: "INC-2026-00143",
    status: "resolved",
    severity: "high",
    type: "operational",
    title:
      "Bad deployment — api-gateway header validation breaking downstream services",
    priority_score: 0.78,
    created_at: "2026-02-17T11:00:00Z",
    updated_at: "2026-02-17T11:05:47Z",
    resolved_at: "2026-02-17T11:05:47Z",
    reflection_count: 0,
    current_agent: "vigil-verifier",
    timing_metrics: {
      time_to_detect_seconds: 42,
      time_to_investigate_seconds: 65,
      time_to_remediate_seconds: 180,
      time_to_verify_seconds: 60,
      total_duration_seconds: 347,
    },
    investigation: {
      investigation_id: "INV-2026-00143",
      root_cause:
        "Deployment of api-gateway v2.14.3 introduced strict header validation that rejects requests missing X-Request-ID header, breaking payment-service, user-service, and notification-svc",
      attack_chain: [],
      blast_radius: [
        {
          asset_id: "api-gateway",
          asset_name: "api-gateway",
          asset_type: "service",
          criticality: "tier-1",
          impact_type: "misconfiguration",
          confidence: 0.98,
        },
        {
          asset_id: "payment-service",
          asset_name: "payment-service",
          asset_type: "service",
          criticality: "tier-1",
          impact_type: "downstream_failure",
          confidence: 0.95,
        },
        {
          asset_id: "user-service",
          asset_name: "user-service",
          asset_type: "service",
          criticality: "tier-2",
          impact_type: "downstream_failure",
          confidence: 0.92,
        },
        {
          asset_id: "notification-svc",
          asset_name: "notification-svc",
          asset_type: "service",
          criticality: "tier-2",
          impact_type: "downstream_failure",
          confidence: 0.85,
        },
      ],
      change_correlation: {
        matched: true,
        commit_sha: "a3f8c21",
        author: "j.martinez",
        pr_number: 847,
        pr_title: "feat: enforce strict header validation on gateway",
        repo: "acme-corp/api-gateway",
        time_gap_seconds: 42,
        confidence: "high",
        files_changed: [
          "src/middleware/headerValidation.ts",
          "src/config/gateway.yaml",
        ],
      },
      mitre_techniques: [],
      recommended_next: "plan_remediation",
    },
    remediation_plan: {
      actions: [
        {
          order: 1,
          action_type: "remediation",
          description:
            "Rollback api-gateway deployment from v2.14.3 to v2.14.2",
          target_system: "kubernetes",
          approval_required: true,
          status: "completed",
          execution_time_ms: 45000,
        },
        {
          order: 2,
          action_type: "remediation",
          description:
            "Restart affected downstream pods to clear connection pools and cached errors",
          target_system: "kubernetes",
          approval_required: false,
          status: "completed",
          execution_time_ms: 30000,
        },
        {
          order: 3,
          action_type: "communication",
          description:
            "Notify #vigil-incidents Slack channel with rollback status and ETA",
          target_system: "slack",
          approval_required: false,
          status: "completed",
          execution_time_ms: 350,
        },
        {
          order: 4,
          action_type: "documentation",
          description:
            "Create Jira ticket OPS-1893 for root cause fix and deployment gate improvement",
          target_system: "jira",
          approval_required: false,
          status: "completed",
          execution_time_ms: 580,
        },
      ],
      success_criteria: [
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 1.0,
          service_name: "api-gateway",
        },
        {
          metric: "latency_p99_ms",
          operator: "lt",
          threshold: 150,
          service_name: "api-gateway",
        },
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 0.5,
          service_name: "payment-service",
        },
      ],
    },
    verification: {
      iteration: 1,
      health_score: 0.92,
      passed: true,
      criteria_results: [
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 1.0,
          service_name: "api-gateway",
          current_value: 0.12,
          passed: true,
        },
        {
          metric: "latency_p99_ms",
          operator: "lt",
          threshold: 150,
          service_name: "api-gateway",
          current_value: 45,
          passed: true,
        },
        {
          metric: "error_rate",
          operator: "lt",
          threshold: 0.5,
          service_name: "payment-service",
          current_value: 0.08,
          passed: true,
        },
      ],
    },
    affected_assets: [
      {
        asset_id: "api-gateway",
        asset_name: "api-gateway",
        asset_type: "service",
        criticality: "tier-1",
        impact_type: "misconfiguration",
        confidence: 0.98,
      },
      {
        asset_id: "payment-service",
        asset_name: "payment-service",
        asset_type: "service",
        criticality: "tier-1",
        impact_type: "downstream_failure",
        confidence: 0.95,
      },
      {
        asset_id: "user-service",
        asset_name: "user-service",
        asset_type: "service",
        criticality: "tier-2",
        impact_type: "downstream_failure",
        confidence: 0.92,
      },
      {
        asset_id: "notification-svc",
        asset_name: "notification-svc",
        asset_type: "service",
        criticality: "tier-2",
        impact_type: "downstream_failure",
        confidence: 0.85,
      },
    ],
    external_links: {
      jira_ticket: "https://acme-corp.atlassian.net/browse/OPS-1893",
      slack_thread:
        "https://acme-corp.slack.com/archives/C05VIGIL/p1739789600",
      github_pr: "https://github.com/acme-corp/api-gateway/pull/847",
      github_commit:
        "https://github.com/acme-corp/api-gateway/commit/a3f8c21",
    },
    _state_timestamps: {
      detected: "2026-02-17T11:00:00Z",
      triaged: "2026-02-17T11:00:42Z",
      investigating: "2026-02-17T11:00:44Z",
      planning: "2026-02-17T11:01:49Z",
      awaiting_approval: "2026-02-17T11:01:52Z",
      executing: "2026-02-17T11:02:15Z",
      verifying: "2026-02-17T11:04:47Z",
      resolved: "2026-02-17T11:05:47Z",
    },
  },
];
