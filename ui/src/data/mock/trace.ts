import type { TraceNode } from "@/types/agent";

/** Full trace tree for incident INC-2026-00142 (Compromised API Key) */
export const mockTraceTree: TraceNode = {
  id: "trace-root-00142",
  name: "vigil-coordinator",
  type: "agent",
  agent_name: "vigil-coordinator",
  duration_ms: 252000,
  status: "completed",
  start_time: "2026-02-17T10:30:00Z",
  input: { incident_id: "INC-2026-00142", alert_severity: "critical" },
  output: { final_status: "resolved", health_score: 0.95 },
  children: [
    // vigil-triage (43s)
    {
      id: "trace-triage-001",
      name: "vigil-triage",
      type: "agent",
      agent_name: "vigil-triage",
      duration_ms: 43000,
      status: "completed",
      start_time: "2026-02-17T10:30:00Z",
      input: { alert_id: "ALT-2026-09281", rule_name: "credential_anomaly" },
      output: { priority_score: 0.92, recommended_next: "investigate" },
      children: [
        {
          id: "trace-triage-tool-001",
          name: "vigil-esql-alert-enrichment",
          type: "tool",
          duration_ms: 400,
          status: "completed",
          start_time: "2026-02-17T10:30:01Z",
          input: { alert_id: "ALT-2026-09281" },
          output: {
            source_ip: "203.0.113.42",
            target_asset: "srv-payment-01",
            geo_anomaly: true,
          },
          children: [],
        },
        {
          id: "trace-triage-tool-002",
          name: "vigil-esql-historical-fp-rate",
          type: "tool",
          duration_ms: 200,
          status: "completed",
          start_time: "2026-02-17T10:30:02Z",
          input: { rule_name: "credential_anomaly", lookback_days: 30 },
          output: { fp_rate: 0.021, total_alerts: 47, confirmed_true: 46 },
          children: [],
        },
        {
          id: "trace-triage-tool-003",
          name: "vigil-search-asset-criticality",
          type: "tool",
          duration_ms: 300,
          status: "completed",
          start_time: "2026-02-17T10:30:03Z",
          input: { asset_id: "srv-payment-01" },
          output: {
            criticality: "tier-1",
            data_classification: "PCI",
            owner_team: "payments",
          },
          children: [],
        },
      ],
    },

    // vigil-investigator (262s)
    {
      id: "trace-investigator-001",
      name: "vigil-investigator",
      type: "agent",
      agent_name: "vigil-investigator",
      duration_ms: 262000,
      status: "completed",
      start_time: "2026-02-17T10:30:43Z",
      input: {
        incident_id: "INC-2026-00142",
        priority_score: 0.92,
        enrichment: { source_ip: "203.0.113.42", target: "srv-payment-01" },
      },
      output: {
        root_cause: "compromised_api_key",
        attack_chain_length: 3,
        blast_radius_count: 3,
      },
      children: [
        {
          id: "trace-inv-tool-001",
          name: "vigil-esql-attack-chain-tracer",
          type: "tool",
          duration_ms: 2100,
          status: "completed",
          start_time: "2026-02-17T10:30:44Z",
          input: {
            source_ip: "203.0.113.42",
            target_asset: "srv-payment-01",
            time_window: "4h",
          },
          output: {
            chain_length: 3,
            techniques: ["T1552", "T1071", "T1041"],
          },
          children: [],
        },
        {
          id: "trace-inv-tool-002",
          name: "vigil-esql-blast-radius",
          type: "tool",
          duration_ms: 1800,
          status: "completed",
          start_time: "2026-02-17T10:30:47Z",
          input: { compromised_asset: "srv-payment-01", depth: 2 },
          output: {
            assets_affected: 3,
            tier1_count: 3,
            data_at_risk: true,
          },
          children: [],
        },
        {
          id: "trace-inv-tool-003",
          name: "vigil-search-mitre-attack",
          type: "tool",
          duration_ms: 900,
          status: "completed",
          start_time: "2026-02-17T10:30:49Z",
          input: { techniques: ["T1552", "T1071", "T1041"] },
          output: {
            mapped_tactics: [
              "credential-access",
              "command-and-control",
              "exfiltration",
            ],
          },
          children: [],
        },
        {
          id: "trace-inv-tool-004",
          name: "vigil-search-threat-intel",
          type: "tool",
          duration_ms: 500,
          status: "completed",
          start_time: "2026-02-17T10:30:50Z",
          input: { indicators: ["203.0.113.42", "198.51.100.10"] },
          output: {
            matches: 1,
            threat_actor: "unknown",
            c2_confirmed: true,
          },
          children: [],
        },
        {
          id: "trace-inv-tool-005",
          name: "vigil-search-incident-similarity",
          type: "tool",
          duration_ms: 300,
          status: "completed",
          start_time: "2026-02-17T10:30:51Z",
          input: { techniques: ["T1552", "T1041"], asset_type: "payment" },
          output: {
            similar_incidents: 2,
            closest_match: "INC-2026-00098",
          },
          children: [],
        },
        {
          id: "trace-inv-tool-006",
          name: "vigil-esql-change-correlation",
          type: "tool",
          duration_ms: 1200,
          status: "completed",
          start_time: "2026-02-17T10:30:52Z",
          input: {
            service: "payment-service",
            time_window: "2h",
          },
          output: { matched: false, no_recent_deployments: true },
          children: [],
        },
      ],
    },

    // vigil-threat-hunter (293s)
    {
      id: "trace-threat-hunter-001",
      name: "vigil-threat-hunter",
      type: "agent",
      agent_name: "vigil-threat-hunter",
      duration_ms: 293000,
      status: "completed",
      start_time: "2026-02-17T10:31:02Z",
      input: {
        incident_id: "INC-2026-00142",
        iocs: ["203.0.113.42", "198.51.100.10"],
        techniques: ["T1552", "T1071", "T1041"],
      },
      output: {
        confirmed_compromised: 3,
        suspected: 2,
        iocs_matched: 7,
      },
      children: [
        {
          id: "trace-th-tool-001",
          name: "vigil-esql-ioc-sweep",
          type: "tool",
          duration_ms: 3200,
          status: "completed",
          start_time: "2026-02-17T10:31:03Z",
          input: {
            indicators: ["203.0.113.42", "198.51.100.10"],
            scope: "all_hosts",
          },
          output: {
            hits: 7,
            hosts_affected: 4,
            earliest_activity: "2026-02-17T08:15:00Z",
          },
          children: [],
        },
        {
          id: "trace-th-tool-002",
          name: "vigil-esql-behavioral-anomaly",
          type: "tool",
          duration_ms: 1800,
          status: "completed",
          start_time: "2026-02-17T10:31:07Z",
          input: {
            asset_ids: [
              "srv-payment-01",
              "srv-api-gateway",
              "db-customers",
            ],
            baseline_window: "7d",
          },
          output: {
            anomalies_detected: 5,
            highest_severity: "critical",
            lateral_movement_indicators: 2,
          },
          children: [],
        },
      ],
    },

    // vigil-commander (45s)
    {
      id: "trace-commander-001",
      name: "vigil-commander",
      type: "agent",
      agent_name: "vigil-commander",
      duration_ms: 45000,
      status: "completed",
      start_time: "2026-02-17T10:31:47Z",
      input: {
        incident_id: "INC-2026-00142",
        root_cause: "compromised_api_key",
        blast_radius_count: 3,
      },
      output: {
        action_count: 5,
        runbook_matched: "RB-SEC-012",
        approval_required: true,
      },
      children: [
        {
          id: "trace-cmd-tool-001",
          name: "vigil-search-runbooks",
          type: "tool",
          duration_ms: 600,
          status: "completed",
          start_time: "2026-02-17T10:31:48Z",
          input: {
            incident_type: "security",
            root_cause: "compromised_api_key",
          },
          output: {
            matched_runbook: "RB-SEC-012",
            title: "API Key Compromise Response",
            confidence: 0.94,
          },
          children: [],
        },
        {
          id: "trace-cmd-tool-002",
          name: "vigil-esql-impact-assessment",
          type: "tool",
          duration_ms: 400,
          status: "completed",
          start_time: "2026-02-17T10:31:49Z",
          input: {
            proposed_actions: [
              "block_ip",
              "disable_account",
              "rotate_keys",
            ],
          },
          output: {
            risk_level: "low",
            estimated_downtime_seconds: 30,
            affected_users_estimate: 0,
          },
          children: [],
        },
      ],
    },

    // vigil-executor (150s)
    {
      id: "trace-executor-001",
      name: "vigil-executor",
      type: "agent",
      agent_name: "vigil-executor",
      duration_ms: 150000,
      status: "completed",
      start_time: "2026-02-17T10:32:05Z",
      input: {
        incident_id: "INC-2026-00142",
        plan_actions: 5,
        approval_granted: true,
      },
      output: {
        actions_completed: 5,
        actions_failed: 0,
        total_execution_ms: 6500,
      },
      children: [
        {
          id: "trace-exec-tool-001",
          name: "vigil-wf-containment/block_ip",
          type: "tool",
          duration_ms: 1200,
          status: "completed",
          start_time: "2026-02-17T10:32:06Z",
          input: {
            action: "block_ip",
            target: "203.0.113.42",
            scope: "perimeter",
          },
          output: { blocked: true, firewall_rule_id: "FW-2026-4521" },
          children: [],
        },
        {
          id: "trace-exec-tool-002",
          name: "vigil-wf-containment/disable_account",
          type: "tool",
          duration_ms: 800,
          status: "completed",
          start_time: "2026-02-17T10:32:08Z",
          input: {
            action: "disable_account",
            account: "svc-payment",
            revoke_sessions: true,
          },
          output: {
            disabled: true,
            sessions_revoked: 3,
          },
          children: [],
        },
        {
          id: "trace-exec-tool-003",
          name: "vigil-wf-remediation/rotate_keys",
          type: "tool",
          duration_ms: 3500,
          status: "completed",
          start_time: "2026-02-17T10:32:09Z",
          input: {
            action: "rotate_keys",
            service: "payment-service",
            invalidate_cache: true,
          },
          output: {
            keys_rotated: 4,
            services_restarted: 1,
            downtime_seconds: 28,
          },
          children: [],
        },
        {
          id: "trace-exec-tool-004",
          name: "vigil-wf-notify/slack",
          type: "tool",
          duration_ms: 400,
          status: "completed",
          start_time: "2026-02-17T10:32:13Z",
          input: {
            channel: "#vigil-incidents",
            template: "incident_remediation_summary",
          },
          output: {
            message_ts: "1739785933.000100",
            thread_url:
              "https://acme-corp.slack.com/archives/C05VIGIL/p1739785800",
          },
          children: [],
        },
        {
          id: "trace-exec-tool-005",
          name: "vigil-wf-ticketing/jira",
          type: "tool",
          duration_ms: 600,
          status: "completed",
          start_time: "2026-02-17T10:32:14Z",
          input: {
            project: "SEC",
            issue_type: "Security Incident",
            title:
              "Compromised API key â€” data exfiltration from payment service",
          },
          output: {
            ticket_key: "SEC-4521",
            url: "https://acme-corp.atlassian.net/browse/SEC-4521",
          },
          children: [],
        },
      ],
    },

    // vigil-verifier (75s)
    {
      id: "trace-verifier-001",
      name: "vigil-verifier",
      type: "agent",
      agent_name: "vigil-verifier",
      duration_ms: 75000,
      status: "completed",
      start_time: "2026-02-17T10:33:12Z",
      input: {
        incident_id: "INC-2026-00142",
        success_criteria_count: 3,
        wait_before_check_ms: 60000,
      },
      output: {
        health_score: 0.95,
        all_criteria_passed: true,
        iteration: 1,
      },
      children: [
        {
          id: "trace-verifier-wait-001",
          name: "post-remediation stabilization wait",
          type: "wait",
          duration_ms: 60000,
          status: "completed",
          start_time: "2026-02-17T10:33:12Z",
          children: [],
        },
        {
          id: "trace-verifier-tool-001",
          name: "vigil-search-baselines",
          type: "tool",
          duration_ms: 300,
          status: "completed",
          start_time: "2026-02-17T10:34:12Z",
          input: {
            services: ["payment-service", "api-gateway"],
            metric_window: "7d",
          },
          output: {
            baselines_loaded: 2,
            metrics_per_service: 3,
          },
          children: [],
        },
        {
          id: "trace-verifier-tool-002",
          name: "vigil-esql-health-comparison",
          type: "tool",
          duration_ms: 800,
          status: "completed",
          start_time: "2026-02-17T10:34:13Z",
          input: {
            services: ["payment-service"],
            criteria: [
              "error_rate < 0.5",
              "latency_p99 < 200",
              "blocked_ip_connections = 0",
            ],
          },
          output: {
            health_score: 0.95,
            all_passed: true,
            results: {
              error_rate: 0.08,
              latency_p99: 42,
              blocked_ip_connections: 0,
            },
          },
          children: [],
        },
      ],
    },
  ],
};
